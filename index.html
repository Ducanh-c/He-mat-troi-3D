<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá M·∫∑t Tr·ªùi 3D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            overflow: hidden;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        .info {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white;
            z-index: 10;
            pointer-events: none;
        }

        h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            letter-spacing: 3px;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            letter-spacing: 2px;
        }

        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 0.9em;
            opacity: 0.7;
            text-align: center;
            z-index: 10;
        }

        .brightness-control {
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .brightness-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .brightness-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }

        .brightness-btn:active {
            transform: scale(0.95);
        }

        .tour-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-weight: 600;
        }

        .tour-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .tour-btn.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            animation: tourPulse 1s infinite alternate;
        }

        @keyframes tourPulse {
            0% { box-shadow: 0 0 10px rgba(245, 87, 108, 0.5); }
            100% { box-shadow: 0 0 25px rgba(245, 87, 108, 0.8); }
        }

        #planet-info {
            display: none;
            position: absolute;
            left: 50%;
            top: 90px;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 20px 30px;
            border-radius: 16px;
            z-index: 20;
            min-width: 300px;
            max-width: 500px;
            text-align: left;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            font-size: 1em;
            border: 2px solid rgba(255, 215, 0, 0.3);
            pointer-events: none;
        }

        #planet-info h3 {
            color: #ffd700;
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        #planet-info p {
            margin: 5px 0;
            line-height: 1.5;
        }

        .active-btn {
            box-shadow: 0 0 20px 5px rgba(255,255,255,0.5);
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .subtitle { font-size: 0.9em; }
            .controls { font-size: 0.8em; bottom: 80px; }
            .brightness-control { top: 80px; right: 10px; }
            #planet-info { max-width: 90vw; font-size: 0.9em; }
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div class="info">
        <h1>H·ªÜ M·∫∂T TR·ªúI 3D</h1>
        <p class="subtitle">üñ±Ô∏è Click v√†o h√†nh tinh ƒë·ªÉ xem th√¥ng tin chi ti·∫øt</p>
    </div>

    <div id="planet-info"></div>

    <div class="brightness-control">
        <button class="tour-btn" id="tour-btn" onclick="toggleGuidedTour()">üöÄ Guided Tour</button>
        <button class="brightness-btn" onclick="toggleBrightness()">üí°</button>
    </div>
    
    <div class="controls">
        K√©o chu·ªôt ƒë·ªÉ xoay | üîç Scroll ƒë·ªÉ zoom
        <div style="margin-top: 15px;">
            <button id="btn-pause" onclick="togglePause()" class="brightness-btn" style="margin: 2px; font-size: 0.9em; padding: 8px 16px;">
                ‚è∏Ô∏è T·∫°m d·ª´ng
            </button>
            <button onclick="adjustSpeed(0.5)" class="brightness-btn" style="margin: 2px; font-size: 0.9em; padding: 8px 16px;">
                üêå 0.5x
            </button>
            <span style="color: #ffd700; font-weight: 600; font-size: 1em; padding: 0 10px;">
                <span id="current-speed">1.0x</span>
            </span>
            <button onclick="adjustSpeed(2)" class="brightness-btn" style="margin: 2px; font-size: 0.9em; padding: 8px 16px;">
                üöÄ 2x
            </button>
            <button onclick="showAllPlanets()" class="brightness-btn" style="margin: 2px; font-size: 0.9em; padding: 8px 16px;">
                üåç To√†n c·∫£nh
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, planets = [];
        let mouseX = 0, mouseY = 0;
        let targetX = 0, targetY = 0;
        let ambientLight, sunLight;
        let isDarkMode = true;
        let planetGroups = [];
        let simulationSpeed = 1.0;
        let originalSpeeds = [];
        let raycaster, mouse;
        let isOnTour = false;
        let tourIndex = 0;
        let tourTimer = 0;
        let clickablePlanets = [];

        const planetData = [
            {
                name: "Th·ªßy",
                size: 0.8,
                distance: 12,
                color: 0x8c7853,
                speed: 0.008,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "3.3 √ó 10¬≤¬≥ kg",
                distanceEarth: "77 tri·ªáu km",
                info: "H√†nh tinh nh·ªè nh·∫•t v√† g·∫ßn M·∫∑t Tr·ªùi nh·∫•t. B·ªÅ m·∫∑t ƒë·∫ßy h·ªë va ch·∫°m gi·ªëng M·∫∑t TrƒÉng."
            },
            {
                name: "Kim",
                size: 1.5,
                distance: 18,
                color: 0xffc649,
                speed: 0.006,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "4.87 √ó 10¬≤‚Å¥ kg",
                distanceEarth: "41 tri·ªáu km",
                info: "H√†nh tinh n√≥ng nh·∫•t (462¬∞C), quay ng∆∞·ª£c chi·ªÅu. Kh√≠ quy·ªÉn d√†y ƒë·∫∑c CO‚ÇÇ."
            },
            {
                name: "Tr√°i ƒê·∫•t",
                size: 1.6,
                distance: 25,
                color: 0x4a90e2,
                speed: 0.005,
                age: "4.54 t·ª∑ nƒÉm",
                mass: "5.97 √ó 10¬≤‚Å¥ kg",
                distanceEarth: "0 km",
                info: "H√†nh tinh duy nh·∫•t c√≥ s·ª± s·ªëng. 71% b·ªÅ m·∫∑t l√† n∆∞·ªõc, c√≥ 1 m·∫∑t trƒÉng."
            },
            {
                name: "H·ªèa",
                size: 1.2,
                distance: 32,
                color: 0xe27b58,
                speed: 0.004,
                age: "4.6 t·ª∑ nƒÉm",
                mass: "6.42 √ó 10¬≤¬≥ kg",
                distanceEarth: "78 tri·ªáu km",
                info: "H√†nh tinh ƒê·ªè. C√≥ n√∫i l·ª≠a Olympus Mons cao nh·∫•t h·ªá m·∫∑t tr·ªùi (25km)."
            },
            {
                name: "M·ªôc",
                size: 3.5,
                distance: 45,
                color: 0xc88b3a,
                speed: 0.003,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "1.90 √ó 10¬≤‚Å∑ kg",
                distanceEarth: "628 tri·ªáu km",
                info: "H√†nh tinh l·ªõn nh·∫•t. C√≥ V·∫øt ƒê·ªè L·ªõn - c∆°n b√£o kh·ªïng l·ªì t·ªìn t·∫°i 300 nƒÉm."
            },
            {
                name: "Th·ªï",
                size: 3,
                distance: 58,
                color: 0xfad5a5,
                speed: 0.002,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "5.68 √ó 10¬≤‚Å∂ kg",
                distanceEarth: "1.2 t·ª∑ km",
                info: "N·ªïi ti·∫øng v·ªõi v√†nh ƒëai bƒÉng v√† ƒë√° tuy·ªát ƒë·∫πp. M·∫≠t ƒë·ªô th·∫•p h∆°n n∆∞·ªõc."
            },
            {
                name: "Thi√™n V∆∞∆°ng",
                size: 2.2,
                distance: 70,
                color: 0x4fc3f7,
                speed: 0.0015,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "8.68 √ó 10¬≤‚Åµ kg",
                distanceEarth: "2.6 t·ª∑ km",
                info: "Quay nghi√™ng 98¬∞ nh∆∞ lƒÉn tr√™n qu·ªπ ƒë·∫°o. M√†u xanh t·ª´ kh√≠ metan."
            },
            {
                name: "H·∫£i V∆∞∆°ng",
                size: 2.1,
                distance: 82,
                color: 0x4169e1,
                speed: 0.001,
                age: "4.5 t·ª∑ nƒÉm",
                mass: "1.02 √ó 10¬≤‚Å∂ kg",
                distanceEarth: "4.3 t·ª∑ km",
                info: "H√†nh tinh xa nh·∫•t. C√≥ gi√≥ m·∫°nh nh·∫•t h·ªá m·∫∑t tr·ªùi (2000 km/h)."
            },
        ];

        function createPlanetTexture(color) {
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 512;
            const ctx = canvas.getContext('2d');
            
            const gradient = ctx.createRadialGradient(200, 200, 50, 256, 256, 256);
            const r = (color >> 16) & 255;
            const g = (color >> 8) & 255;
            const b = color & 255;
            
            gradient.addColorStop(0, `rgb(${Math.min(r+50, 255)}, ${Math.min(g+50, 255)}, ${Math.min(b+50, 255)})`);
            gradient.addColorStop(0.5, `rgb(${r}, ${g}, ${b})`);
            gradient.addColorStop(1, `rgb(${Math.max(r-50, 0)}, ${Math.max(g-50, 0)}, ${Math.max(b-50, 0)})`);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 512, 512);
            
            for (let i = 0; i < 80; i++) {
                const x = Math.random() * 512;
                const y = Math.random() * 512;
                const size = Math.random() * 25 + 5;
                const darkness = Math.random() * 0.4;
                
                ctx.fillStyle = `rgba(0, 0, 0, ${darkness})`;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
            
            for (let i = 0; i < 40; i++) {
                const x = Math.random() * 512;
                const y = Math.random() * 512;
                const size = Math.random() * 15 + 3;
                const lightness = Math.random() * 0.3;
                
                ctx.fillStyle = `rgba(255, 255, 255, ${lightness})`;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
            
            return new THREE.CanvasTexture(canvas);
        }

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 50, 100);
            camera.lookAt(0, 0, 0);
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            document.getElementById("canvas-container").appendChild(renderer.domElement);
            
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();
            
            ambientLight = new THREE.AmbientLight(0x333333);
            scene.add(ambientLight);
            
            sunLight = new THREE.PointLight(0xffffff, 2, 300);
            sunLight.position.set(0, 0, 0);
            sunLight.castShadow = true;
            scene.add(sunLight);
            
            const sunGeometry = new THREE.SphereGeometry(5, 32, 32);
            const sunMaterial = new THREE.MeshBasicMaterial({
                color: 0xfdb813,
                emissive: 0xfdb813,
                emissiveIntensity: 3,
            });
            const sun = new THREE.Mesh(sunGeometry, sunMaterial);
            scene.add(sun);
            window.sunMesh = sun;
            
            const glowGeometry = new THREE.SphereGeometry(5.7, 32, 32);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0xffffee,
                transparent: true,
                opacity: 0.32,
                blending: THREE.AdditiveBlending,
            });
            const sunGlowMesh = new THREE.Mesh(glowGeometry, glowMaterial);
            scene.add(sunGlowMesh);
            
            const sunGlow = new THREE.PointLight(0xfdb813, 1.5, 200);
            sun.add(sunGlow);
            
            planetData.forEach((data, index) => {
                const planetGroup = new THREE.Group();
                
                const orbitGeometry = new THREE.RingGeometry(data.distance - 0.1, data.distance + 0.1, 64);
                const orbitMaterial = new THREE.MeshBasicMaterial({
                    color: 0x444444,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.3,
                });
                const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                orbit.rotation.x = Math.PI / 2;
                scene.add(orbit);
                
                const texture = createPlanetTexture(data.color);
                const planetGeometry = new THREE.SphereGeometry(data.size, 32, 32);
                const planetMaterial = new THREE.MeshPhongMaterial({
                    map: texture,
                    shininess: 30,
                });
                const planet = new THREE.Mesh(planetGeometry, planetMaterial);
                planet.position.x = data.distance;
                planet.castShadow = true;
                planet.receiveShadow = true;
                planet.userData = { planetIndex: index };
                
                clickablePlanets.push(planet);
                
                planetGroup.add(planet);
                scene.add(planetGroup);
                planetGroups.push(planetGroup);

                if (data.name === "Th·ªï") {
                    const ringGeometry = new THREE.RingGeometry(data.size * 1.5, data.size * 2.2, 32);
                    const ringMaterial = new THREE.MeshBasicMaterial({
                        color: 0xfad5a5,
                        side: THREE.DoubleSide,
                        transparent: true,
                        opacity: 0.7,
                    });
                    const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                    ring.rotation.x = Math.PI / 2;
                    planet.add(ring);
                }

                planets.push({
                    group: planetGroup,
                    planet: planet,
                    speed: data.speed,
                    distance: data.distance,
                    angle: Math.random() * Math.PI * 2,
                });
            });
            
            originalSpeeds = planets.map(p => p.speed);
            
            const starsGeometry = new THREE.BufferGeometry();
            const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.5 });
            
            const starsVertices = [];
            for (let i = 0; i < 3000; i++) {
                const x = (Math.random() - 0.5) * 500;
                const y = (Math.random() - 0.5) * 500;
                const z = (Math.random() - 0.5) * 500;
                starsVertices.push(x, y, z);
            }
            
            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
            const stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('click', onMouseClick);
            document.addEventListener('wheel', onWheel);
            window.addEventListener('resize', onWindowResize);
        }

        function onMouseMove(event) {
            mouseX = (event.clientX - window.innerWidth / 2) / 100;
            mouseY = (event.clientY - window.innerHeight / 2) / 100;
            
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        }

        function onMouseClick(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(clickablePlanets);
            
            if (intersects.length > 0) {
                const clickedPlanet = intersects[0].object;
                const planetIndex = clickedPlanet.userData.planetIndex;
                showPlanetInfo(planetIndex);
            }
        }

        function showPlanetInfo(index) {
            const data = planetData[index];
            const infoDiv = document.getElementById('planet-info');
            
            infoDiv.innerHTML = `
                <h3>ü™ê ${data.name}</h3>
                <p><strong>Tu·ªïi:</strong> ${data.age}</p>
                <p><strong>Kh·ªëi l∆∞·ª£ng:</strong> ${data.mass}</p>
                <p><strong>Kho·∫£ng c√°ch ƒë·∫øn M·∫∑t Tr·ªùi:</strong> ${data.distance * 10} tri·ªáu km</p>
                <p><strong>Kho·∫£ng c√°ch ƒë·∫øn Tr√°i ƒê·∫•t:</strong> ${data.distanceEarth}</p>
                <p style="margin-top: 10px; font-style: italic;">${data.info}</p>
            `;
            
            infoDiv.style.display = 'block';
            
            setTimeout(() => {
                infoDiv.style.display = 'none';
            }, 8000);
        }

        function toggleGuidedTour() {
            isOnTour = !isOnTour;
            const tourBtn = document.getElementById('tour-btn');
            
            if (isOnTour) {
                tourBtn.classList.add('active');
                tourBtn.textContent = '‚èπÔ∏è D·ª´ng Tour';
                tourIndex = 0;
                tourTimer = 0;
                startTourSegment();
            } else {
                tourBtn.classList.remove('active');
                tourBtn.textContent = 'üöÄ Guided Tour';
                showAllPlanets();
            }
        }

        function startTourSegment() {
            if (!isOnTour || tourIndex >= planetData.length) {
                isOnTour = false;
                const tourBtn = document.getElementById('tour-btn');
                tourBtn.classList.remove('active');
                tourBtn.textContent = 'üöÄ Guided Tour';
                showAllPlanets();
                return;
            }
            
            showPlanetInfo(tourIndex);
            
            const planet = planets[tourIndex].planet;
            const targetPos = planet.getWorldPosition(new THREE.Vector3());
            
            camera.position.x = targetPos.x;
            camera.position.y = targetPos.y + 8;
            camera.position.z = targetPos.z + 15;
            camera.lookAt(targetPos);
            
            tourTimer = 0;
        }

        function onWheel(event) {
            camera.position.z += event.deltaY * 0.05;
            camera.position.z = Math.max(30, Math.min(150, camera.position.z));
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function toggleBrightness() {
            isDarkMode = !isDarkMode;
            
            if (isDarkMode) {
                renderer.setClearColor(0x000000);
                ambientLight.intensity = 0.3;
                sunLight.intensity = 2;
            } else {
                renderer.setClearColor(0x1a1a2e);
                ambientLight.intensity = 0.8;
                sunLight.intensity = 1.5;
            }
        }

        function togglePause() {
            const btn = document.getElementById("btn-pause");
            if (simulationSpeed === 0) {
                simulationSpeed = 1.0;
                btn.textContent = "‚è∏Ô∏è T·∫°m d·ª´ng";
                btn.classList.remove("active-btn");
            } else {
                simulationSpeed = 0;
                btn.textContent = "‚ñ∂Ô∏è Ti·∫øp t·ª•c";
                btn.classList.add("active-btn");
            }
        }

        function adjustSpeed(factor) {
            simulationSpeed = Math.max(0.1, Math.min(5.0, simulationSpeed * factor));
            document.getElementById("current-speed").textContent = `${simulationSpeed.toFixed(1)}x`;
            
            const pauseBtn = document.getElementById("btn-pause");
            if (simulationSpeed > 0) {
                pauseBtn.textContent = "‚è∏Ô∏è T·∫°m d·ª´ng";
                pauseBtn.classList.remove("active-btn");
            }
        }

        function showAllPlanets() {
            document.getElementById("planet-info").style.display = "none";
            planetGroups.forEach(g => g.visible = true);
            if (window.sunMesh) window.sunMesh.visible = true;
            
            camera.position.set(0, 50, 100);
            camera.lookAt(0, 0, 0);
            
            renderer.setClearColor(isDarkMode ? 0x000000 : 0x1a1a2e);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            if (isOnTour) {
                tourTimer++;
                if (tourTimer > 300) {
                    tourIndex++;
                    startTourSegment();
                }
            } else {
                targetX = mouseX * 0.3;
                targetY = mouseY * 0.3;
                
                camera.position.x += (targetX - camera.position.x) * 0.05;
                camera.position.y += (targetY - camera.position.y + 50) * 0.05;
                camera.lookAt(0, 0, 0);
            }
            
            planets.forEach((data, index) => {
                data.angle += originalSpeeds[index] * simulationSpeed;
                data.group.rotation.y = data.angle;
                data.planet.rotation.y += 0.01 * simulationSpeed;
            });
            
            renderer.render(scene, camera);
        }
        
        init();
        animate();
    </script>
</body>
</html>